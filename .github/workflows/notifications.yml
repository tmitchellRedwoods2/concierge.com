name: Deployment Notifications

on:
  workflow_run:
    workflows: ["CI/CD Pipeline"]
    types:
      - completed

jobs:
  notify:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    
    steps:
    - name: Success Notification
      run: |
        echo "ğŸ‰ DEPLOYMENT SUCCESS!"
        echo "ğŸ“… Date: $(date)"
        echo "ğŸ”— Commit: ${{ github.event.workflow_run.head_sha }}"
        echo "ğŸ‘¤ Author: ${{ github.event.workflow_run.head_commit.author.name }}"
        echo "ğŸ“ Message: ${{ github.event.workflow_run.head_commit.message }}"
        echo "âœ… All tests passed"
        echo "ğŸš€ Streamlit Cloud deployment triggered"
        echo "ğŸŒ Your app should be live shortly!"
        
        # You can add webhook notifications here
        # Example: curl -X POST -H 'Content-type: application/json' \
        # --data '{"text":"ğŸ‰ Deployment successful! Tests passed and app is live!"}' \
        # YOUR_WEBHOOK_URL

  notify-failure:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    
    steps:
    - name: Failure Notification
      run: |
        echo "âŒ DEPLOYMENT FAILED!"
        echo "ğŸ“… Date: $(date)"
        echo "ğŸ”— Commit: ${{ github.event.workflow_run.head_sha }}"
        echo "ğŸ‘¤ Author: ${{ github.event.workflow_run.head_commit.author.name }}"
        echo "ğŸ“ Message: ${{ github.event.workflow_run.head_commit.message }}"
        echo "ğŸ’¥ Tests failed or deployment error occurred"
        echo "ğŸ” Check the GitHub Actions logs for details"
        
        # You can add webhook notifications here
        # Example: curl -X POST -H 'Content-type: application/json' \
        # --data '{"text":"âŒ Deployment failed! Check GitHub Actions."}' \
        # YOUR_WEBHOOK_URL
